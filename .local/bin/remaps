#!/bin/sh

# This script is called on startup to remap keys.
# Decrease key repeat delay to 300ms and increase key repeat rate to 50 per second.

# if ! pgrep -x "keyd" > /dev/null
# then
#     sudo keyd >/dev/null 2>&1
#     sleep 1
# fi

xset r rate 300 50

input=$(xinput list --name-only | grep Keyboard)

case $input in
    *"Vortexgear"*)
        xmodmap -e "keycode 108 = Hyper_R"
        ;;
    *"HHKB-Hybrid"*)
        xmodmap -e "keysym Menu = Hyper_R"
        ;;
    *"ErgoDox"*)
        xmodmap -e "keysym Menu = Hyper_R"
        ;;
    *)
        xmodmap -e "keycode 94 = Hyper_R"
        ;;
esac

xmodmap -e "remove Mod4 = Hyper_L" -e "add Mod3 = Hyper_R"

# One press function
# killall xcape 2>/dev/null ; xcape -e 'Menu=Hyper_R'

xset -q | grep "Caps Lock:\s*on" && xdotool key Caps_Lock
