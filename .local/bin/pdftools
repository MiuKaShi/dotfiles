#!/bin/sh

# Requires https://github.com/thiagoeliasr/pdftools

# Set variables
file=$(readlink -f "$1")
pdftools=$XDG_CONFIG_HOME/script/PDFTools.jar

# Define functions
remove_pages() {
    num=$(echo | dmenu -p "Pages:")
    java -jar "$pdftools" remove-pages "$file" "$file" "$(($num - 1))"
    notify-send -t 3000 "Remove Page $num"
}

compress_pdf() {
    java -jar "$pdftools" compress "$file" "$file"
    notify-send -t 3000 "Compress PDF"
}

delete_pdf() {
    trash "$file"
    notify-send -t 3000 "Delete PDF!"
}

extract_pages() {
    start=$(echo | dmenu -p "From page:")
    end=$(echo | dmenu -p "To page:")
    qpdf "$file" --pages . "$start"-"$end" -- $HOME/Downloads/extract-output.pdf
    notify-send -t 3000 "Extract successfully"
}

# Prompt user for action
action=$(printf "remove pages\nextract pages\ncompress pdf\ndelete pdf" | dmenu -l 6 -i -p "Pdf tools:")

# Call appropriate function based on user input
case "$action" in
    "remove pages") remove_pages ;;
    "compress pdf") compress_pdf ;;
    "delete pdf") delete_pdf ;;
    "extract pages") extract_pages ;;
esac
