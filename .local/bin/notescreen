#! /bin/sh

unset LIBVA_DRIVER_NAME VDPAU_DRIVER DRI_PRIME

modeldp=$(sudo ddcutil detect | grep "Mfg" | awk '{print $3}')

case $modeldp in
    *"ENC"*)
        xrandr --dpi 108 --fb 4000x2560 --output HDMI-0 --pos 2560x0 --rotate left --output DP-0 --primary --mode 2560x1440 --pos 0x540 --rotate normal --panning 1440x2560+2560+0 --output DP-1 --off --output eDP-1-1 --off
        export LIBVA_DRIVER_NAME=nvidia
        export VDPAU_DRIVER=nvidia
        export DRI_PRIME=1
        xrdb ${XDG_CONFIG_HOME:-$HOME/.config}/displayset/labxresources &
        xrdbpid=$!
        ;;
    *"PHL"* | *"HKC"*)
        xrandr --dpi 138 --fb 6000x3840 --output HDMI-0 --scale 1.5x1.5 --pos 0x0 --rotate left --output DP-0 --primary --mode 3840x2160 --pos 2160x345 --rotate normal --panning 2160x3840+3840+0 --output DP-1 --off --output eDP-1-1 --off
        export LIBVA_DRIVER_NAME=nvidia
        export VDPAU_DRIVER=nvidia
        export DRI_PRIME=1
        nvidia-settings --assign "CurrentMetaMode=DPY-1: nvidia-auto-select @3840x2160 +2160+253 {AllowGSYNCCompatible=On, ViewPortIn=3840x2160, ViewPortOut=3840x2160+0+0}, DPY-0: nvidia-auto-select @2160x3840 +0+0 {ViewPortIn=2160x3840, ViewPortOut=2560x1440+0+0, Rotation=90}"
        xrdb ${XDG_CONFIG_HOME:-$HOME/.config}/displayset/homexresources &
        xrdbpid=$!
        ;;
    *)
        xrandr --dpi 96 --output HDMI-0 --off --output DP-0 --off --output DP-1 --off --output eDP-1-1 --mode 1920x1080 --pos 0x0 --rotate normal --output DP-1-1 --off --output HDMI-1-1 --off
        export LIBVA_DRIVER_NAME=iHD
        export VDPAU_DRIVER=va_gl
        xrdb ${XDG_CONFIG_HOME:-$HOME/.config}/displayset/xresources &
        xrdbpid=$!
        ;;
esac

# xrdb ${XDG_CONFIG_HOME:-$HOME/.config}/displayset/homexresources & xrdbpid=$!
