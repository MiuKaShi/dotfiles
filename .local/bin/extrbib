#!/bin/sh

file=$(readlink -f "$1")
name=$(basename "$file")
fname="${name%.*}"
dir=${file%/*}

cd $dir

function getbib {
    curl -v -H "Accept: application/x-bibtex" --form input=@$file 104.237.11.64:8070/api/processReferences > $fname.bib
    # anystyle -f bib find --no-layout $file > $fname.bib
    notify-send -t 3000 "Bibtex" "Bibtex file created"
}

if [[ ! -f $fname.bib ]]; then
    getbib 
fi

nvim $fname.bib 
