#!/bin/sh

# This script is called on startup to remap keys.
# Decrease key repeat delay to 300ms and increase key repeat rate to 50 per second.

# if ! pgrep -x "keyd" > /dev/null
# then
#     sudo keyd >/dev/null 2>&1
#     sleep 1
# fi

xset r rate 300 50

# set ALT_R and less to menu, then menu to Hyper_R
xmodmap -e "keycode 108 = Menu"
xmodmap -pke | grep -q "keycode  94" && xmodmap -e "keycode 94 = Menu"
xmodmap -e "keysym Menu = Hyper_R"
xmodmap -e "remove Mod4 = Hyper_L" -e "remove Mod1 = Hyper_R"
xmodmap -e "add Mod3 = Hyper_R" -e "remove Mod3 = ISO_Level5_Shift"

# One press function
# killall xcape 2>/dev/null ; xcape -e 'Menu=Hyper_R'

xset -q | grep -q "Caps Lock:\s*on" && xdotool key Caps_Lock
